$("div#chat_messages").html("<%= escape_javascript(render '/messages/messages', active_room: @chatroom, messages: @messages ) %>");
$("div#chatroom_message").html("<%= escape_javascript(render 'chatroom_message', chatroom: @chatroom ) %>");
$("div#chatroom_title").html("<%= escape_javascript(render 'chatroom_title', chatroom: @chatroom ) %>");
$(function() {
	var objDiv = document.getElementById("chat_messages");
	objDiv.scrollTop = objDiv.scrollHeight;

	const zone = document.querySelector('.dropzonable')
	  const input = document.querySelector('#message-attachment')
	  const form = document.querySelector('#new_message')

	  if (zone) {
	    const dropzone = new Dropzone(zone, { 
	      url: form.action.replace('messages.js', 'dropfiles'),
	      error: function(file, errorMessage, xhr) {
	        console.log(errorMessage)
	        toastr.options = {
	            closeButton: true,
	            progressBar: true,
	            showMethod: 'slideDown',
	            positionClass: 'toast-bottom-left',
	            timeOut: 7000
	        }

	        toastr.error(errorMessage.error)
	      }
	    })

	    dropzone.on("complete", function(file) {
	      dropzone.removeFile(file);
	    });
	  }

	// var badge = document.getElementById("badge-<%= @chatroom.id %>");
	// badge.innerHTML = "";
	// badge.classList.remove("badge");
	// badge.classList.remove("badge-warning");

})