<div class="modal fade bd-example-modal-lg modal-gray" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" id="manageUsers-<%= order.id %>">
  <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <p class="modal-title" id="exampleModalLongTitle">
          Manage User to Assign on this Order
        </p>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="form" id="edit_order_user" action="/orders/update_assign_user" accept-charset="UTF-8" method="post">
          <input type="hidden" name="order_user[order_id]" id="order_user_order_id" value="<%= order.id %>">
          <div class="form-group row required">
            <label class="col-sm-2 col-form-label label-form col-form-label-right">Regional Director</label>
            <div class="col-sm-10">
              <select class="selectpicker2 form-control glow-input" data-live-search="true" name="order_user[regional][]" id="order_user_regional[]" multiple>
                <option></option>
                        <% OrderUser.regional_users(order.id).each do |user|  %>
                            <option value="<%= user.id %>" selected><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
                        <% OrderUser.not_in_users(OrderUser.regional(order.id).empty? ? 0 : OrderUser.regional(order.id) + User.where(regional_director: false).pluck(:id)).each do |user| %>
                          <option value="<%= user.id %>"><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
              </select>
            </div>
          </div>

          <div class="form-group row required">
            <label class="col-sm-2 col-form-label label-form col-form-label-right">Client Contacts</label>
            <div class="col-sm-10">
              <select class="selectpicker2 form-control glow-input" data-live-search="true" name="order_user[client_contact][]" id="order_user_client_contact[]" multiple>
                <option></option>
                        <% OrderUser.client_contact_users(order.id).each do |user|  %>
                            <option value="<%= user.id %>" selected><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
                        <% OrderUser.not_in_users(OrderUser.client_contact(order.id).empty? ? 0 : OrderUser.client_contact(order.id) + User.where(client_contacts: false).pluck(:id)).each do |user| %>
                          <option value="<%= user.id %>"><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
              </select>
            </div>
          </div>

          <div class="form-group row required">
            <label class="col-sm-2 col-form-label label-form col-form-label-right">Communications</label>
            <div class="col-sm-10">
              <select class="selectpicker2 form-control glow-input" data-live-search="true" name="order_user[comms][]" id="order_user_art[]" multiple>
                <option></option>
                        <% OrderUser.comms_users(order.id).each do |user|  %>
                            <option value="<%= user.id %>" selected><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
                        <% OrderUser.not_in_users(OrderUser.comms(order.id).empty? ? 0 : OrderUser.comms(order.id) + User.where(communications: false).pluck(:id)).each do |user| %>
                          <option value="<%= user.id %>"><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
              </select>

            </div>
          </div>

          <div class="form-group row required">
            <label class="col-sm-2 col-form-label label-form col-form-label-right">Art Director</label>
            <div class="col-sm-10">
              <select class="selectpicker2 form-control glow-input" data-live-search="true" name="order_user[art][]" id="order_user_art[]" multiple>
                <option></option>
                        <% OrderUser.art_users(order.id).each do |user|  %>
                            <option value="<%= user.id %>" selected><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
                        <% OrderUser.not_in_users(OrderUser.art(order.id).empty? ? 0 : OrderUser.art(order.id) + User.where(art_director: false).pluck(:id)).each do |user| %>
                          <option value="<%= user.id %>"><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
              </select>
            </div>
          </div>

          <div class="form-group row required">
            <label class="col-sm-2 col-form-label label-form col-form-label-right">Designers</label>
            <div class="col-sm-10">
              <select class="selectpicker2 form-control glow-input" data-live-search="true" name="order_user[designer][]" id="order_user_designer[]" multiple>
                <option></option>
                        <% OrderUser.designer_users(order.id).each do |user|  %>
                            <option value="<%= user.id %>" selected><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
                        <% OrderUser.not_in_users(OrderUser.designer(order.id).empty? ? 0 : OrderUser.designer(order.id) + User.where(designers: false).pluck(:id)).each do |user| %>
                          <option value="<%= user.id %>"><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
              </select>
            </div>
          </div>

          <div class="form-group row required">
            <label class="col-sm-2 col-form-label label-form col-form-label-right">Processor</label>
            <div class="col-sm-10">
              <select class="selectpicker2 form-control glow-input" data-live-search="true" name="order_user[processor][]" id="order_user_processor[]" multiple>
                <option></option>
                        <% OrderUser.processor_users(order.id).each do |user|  %>
                            <option value="<%= user.id %>" selected><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
                        <% OrderUser.not_in_users(OrderUser.processor(order.id).empty? ? 0 : OrderUser.processor(order.id) + User.where(processor: false).pluck(:id)).each do |user| %>
                          <option value="<%= user.id %>"><%= [user.first_name, user.last_name].join(' ') %></option>
                        <% end %>
              </select>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <div class="buttons">
          <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
        </div>
        <div class="buttons">
          <button type="button" class="btn btn-info" onclick="submitForm('edit_order_user', $(this))">Update</button>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  $( document ).ready(function() {
    $(".selectpicker2").selectpicker();

      $(function() {
        $('[data-toggle="tooltip"]').tooltip();
        $(".dropdown").bind("keydown", function(event) {
          if (event.keyCode === 9) {
            $(this)
              .find(".selectpicker2")
              .selectpicker("toggle");
          }
        });
      })

  });
</script>